<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AparÄ±ram Formu</title>

  <style>
    :root{
      --bg1:#0b1220;
      --bg2:#0f1b33;
      --line:rgba(255,255,255,.10);
      --text:#eaf2ff;
      --muted:#a9b7d6;

      --accent:#7c3aed;
      --accent2:#06b6d4;

      --danger:#ff4d4d;
      --danger2:#ff2f2f;

      --ok:#22c55e;

      --radius:18px;
      --shadow: 0 18px 45px rgba(0,0,0,.35);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    html{ scroll-behavior: smooth; }

    body{
      margin:0;
      padding:22px;
      color:var(--text);
      font-family: "Segoe UI", "Noto Sans", "DejaVu Sans", Arial, system-ui, -apple-system, sans-serif;
      background:
        radial-gradient(1200px 700px at 10% 10%, rgba(124,58,237,.28), transparent 55%),
        radial-gradient(900px 600px at 90% 15%, rgba(6,182,212,.18), transparent 50%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: geometricPrecision;
    }

    .container{ max-width: 1150px; margin: 0 auto; }

    .top-alert{
      border: 1px solid rgba(255,77,77,.55);
      background: linear-gradient(180deg, rgba(255,77,77,.16), rgba(255,77,77,.08));
      box-shadow: 0 10px 30px rgba(255,77,77,.10);
      color: #ffecec;
      padding: 14px 16px;
      border-radius: 16px;
      font-weight: 900;
      font-size: 18px;
      line-height: 1.35;
      margin-bottom: 16px;
    }
    .top-alert b{ color:#ffffff; }

    h2{ margin: 10px 0 8px 0; font-size: 26px; letter-spacing:.2px; }

    /* âœ… BaÅŸlÄ±q altÄ± 2 dÃ¼ymÉ™ */
    .headline-actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin: 0 0 14px 0;
      align-items:center;
    }

    .soft-btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      padding: 9px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: #eaf2ff;
      font-weight: 1000;
      font-size: 13px;
      cursor:pointer;
      user-select:none;
      transition: .15s ease;
      text-decoration:none;
      box-shadow: 0 10px 22px rgba(0,0,0,.22);
    }
    .soft-btn:hover{ transform: translateY(-1px); }

    .soft-btn.red{
      border-color: rgba(255,77,77,.55);
      background: linear-gradient(180deg, rgba(255,77,77,.20), rgba(255,77,77,.08));
      color:#ffecec;
    }
    .soft-btn.green{
      border-color: rgba(34,197,94,.50);
      background: linear-gradient(180deg, rgba(34,197,94,.20), rgba(34,197,94,.08));
      color:#eafff2;
    }

    .wrap{ display:flex; gap:18px; align-items:flex-start; }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    form.card{ flex: 0 0 460px; max-width: 460px; padding: 16px; }
    .side-info.card{ flex:1; min-width: 300px; padding: 16px; }

    .section-title{
      margin:0 0 10px 0;
      font-size: 15px;
      color: #d7e3ff;
      font-weight: 900;
      display:flex;
      gap:10px;
      align-items:center;
    }
    .section-title .dot{
      width:10px; height:10px; border-radius:999px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: 0 0 0 3px rgba(124,58,237,.15);
    }

    label{
      display:block;
      margin-top: 12px;
      font-weight: 900;
      color:#dce8ff;
      font-size: 13px;
    }

    .muted{ color: var(--muted); font-size: 12.8px; margin-top: 7px; line-height: 1.45; }

    input[type="text"], input[type="date"], select{
      width:100%;
      padding: 11px 12px;
      margin-top: 7px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(8,14,26,.55);
      color: var(--text);
      outline: none;
      font-size: 14px;
      transition: .15s ease;
    }
    input::placeholder{ color: rgba(233,243,255,.55); }

    input:focus, select:focus{
      border-color: rgba(124,58,237,.65);
      box-shadow: 0 0 0 4px rgba(124,58,237,.15);
    }

    .checkbox-group{ display:flex; flex-wrap:wrap; gap:10px; margin-top: 9px; }

    .chip{
      display:flex;
      gap:8px;
      align-items:center;
      padding: 9px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(8,14,26,.45);
      user-select:none;
      cursor:pointer;
      transition:.15s ease;
      font-weight: 800;
      color:#dce8ff;
    }
    .chip:hover{
      transform: translateY(-1px);
      border-color: rgba(6,182,212,.55);
      box-shadow: 0 10px 25px rgba(0,0,0,.25);
    }
    .chip input{ transform: scale(1.05); }

    .error{
      display:none;
      margin-top: 8px;
      color: #ffe0e0;
      background: rgba(255,77,77,.14);
      border: 1px solid rgba(255,77,77,.42);
      padding: 10px 11px;
      border-radius: 12px;
      font-weight: 900;
      font-size: 12.8px;
      line-height: 1.35;
    }

    .warn-note{
      margin-top: 10px;
      color: #fff2f2;
      background: rgba(255,77,77,.12);
      border: 1px solid rgba(255,77,77,.35);
      padding: 10px 11px;
      border-radius: 14px;
      font-weight: 900;
      font-size: 12.8px;
      line-height: 1.35;
    }

    .btn{
      margin-top: 14px;
      width:100%;
      padding: 12px 14px;
      border-radius: 16px;
      border: 0;
      cursor:pointer;
      color:#fff;
      font-weight: 900;
      font-size: 14px;
      letter-spacing:.2px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: 0 14px 35px rgba(124,58,237,.25);
      transition: .15s ease;
    }
    .btn:hover{ transform: translateY(-1px); }

    .sub-actions{
      display:flex;
      gap:10px;
      margin-top: 10px;
      flex-wrap:wrap;
    }

    .mini-btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color:#eaf2ff;
      font-weight: 900;
      cursor:pointer;
      transition:.15s ease;
      user-select:none;
      flex:1;
      min-width: 160px;
      text-decoration:none;
    }
    .mini-btn:hover{ transform: translateY(-1px); }
    .mini-btn.danger{
      border-color: rgba(255,77,77,.35);
      background: rgba(255,77,77,.10);
    }
    .mini-btn:disabled{
      opacity:.55;
      cursor:not-allowed;
      transform:none;
    }

    .inline-link-btn.red{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      margin-left: 8px;
      padding: 7px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,77,77,.60);
      background: linear-gradient(180deg, rgba(255,77,77,.98), rgba(255,47,47,.88));
      color: #ffffff;
      font-weight: 1000;
      font-size: 13.5px;
      cursor: pointer;
      user-select:none;
      transition: .15s ease;
      text-decoration:none;
      white-space: nowrap;
      box-shadow: 0 12px 28px rgba(255,77,77,.20);
    }
    .inline-link-btn.red:hover{ transform: translateY(-1px); }

    .inline-link-btn.green{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(34,197,94,.45);
      background: linear-gradient(135deg, rgba(37,211,102,.95), rgba(16,185,129,.95));
      color:#06210f;
      font-weight: 1000;
      font-size: 13px;
      text-decoration:none;
      cursor:pointer;
      transition:.15s ease;
      box-shadow: 0 14px 30px rgba(34,197,94,.12);
      width: fit-content;
    }
    .inline-link-btn.green:hover{ transform: translateY(-1px); }

    .status-row{
      margin-top: 10px;
      display:flex;
      gap:10px;
      align-items:flex-start;
      flex-wrap:wrap;
    }
    .status-pill{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      font-weight: 900;
      font-size: 12.5px;
    }
    .status-pill.ok{ border-color: rgba(34,197,94,.35); }
    .file-name{
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.35;
      margin-top: 6px;
    }

    .side-info ul{ margin: 0; padding-left: 18px; line-height: 1.55; color:#d7e3ff; font-size: 13px; }

    .pill{
      display:inline-block;
      padding: 4px 9px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 1000;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      margin: 3px 8px 0 0;
    }

    .danger-text{
      margin-top: 12px;
      padding: 12px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,138,138,.35);
      background: linear-gradient(180deg, rgba(255,138,138,.14), rgba(255,138,138,.06));
      color:#fff1f1;
      font-weight: 900;
      line-height: 1.35;
      font-size: 13px;
    }

    .rule-title{
      font-weight: 1000;
      font-size: 15px;
      color:#ffffff;
      line-height: 1.25;
      margin-bottom: 6px;
    }
    .rule-block{
      padding: 12px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      margin-top: 10px;
    }

    .result{ margin-top: 18px; padding: 16px; }
    pre{
      margin:0;
      white-space: pre-wrap;
      background: rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 16px;
      padding: 12px;
      color: #eaf2ff;
      line-height: 1.45;
      font-weight: 800;
    }

    .action-row{ display:flex; gap:12px; flex-wrap:wrap; margin-top: 12px; }

    .copy-btn, .wa-send-btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: 11px 12px;
      border-radius: 14px;
      text-decoration:none;
      font-weight: 1000;
      transition:.15s ease;
      user-select:none;
      width: fit-content;
      border: none;
    }

    .copy-btn{
      background: linear-gradient(135deg, rgba(37,99,235,.95), rgba(99,102,241,.95));
      color:#fff;
      cursor:pointer;
    }
    .copy-btn:hover{ transform: translateY(-1px); }

    .wa-send-btn{
      background: linear-gradient(135deg, rgba(37,211,102,.95), rgba(16,185,129,.95));
      color:#06210f;
      cursor:pointer;
    }
    .wa-send-btn:hover{ transform: translateY(-1px); }

    .big-hint{
      margin-top: 10px;
      font-weight: 1000;
      color:#eaf2ff;
      font-size: 16px;
      line-height: 1.35;
    }

    .big-danger{
      margin-top: 10px;
      border-radius: 18px;
      padding: 12px 12px;
      border: 2px solid rgba(255,47,47,.70);
      background: linear-gradient(180deg, rgba(255,47,47,.22), rgba(255,47,47,.10));
      color: #ffd6d6;
      font-weight: 1000;
      font-size: 16px;
      line-height: 1.35;
      letter-spacing: .2px;
    }
    .big-danger b{ color:#ffffff; }

    .danger-footer{
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(255,77,77,.10);
      border: 1px solid rgba(255,77,77,.35);
      color: #ffecec;
      font-weight: 1000;
      line-height: 1.35;
      font-size: 13px;
    }

    .result p{ margin: 10px 0 0 0; color: var(--muted); font-size: 13px; line-height: 1.55; }

    .toast{
      position: fixed;
      left: 50%;
      bottom: 22px;
      transform: translateX(-50%);
      background: rgba(0,0,0,.6);
      border: 1px solid rgba(255,255,255,.14);
      color: #fff;
      padding: 10px 12px;
      border-radius: 14px;
      box-shadow: 0 18px 50px rgba(0,0,0,.4);
      font-weight: 900;
      font-size: 13px;
      opacity: 0;
      pointer-events:none;
      transition: .18s ease;
      z-index: 9999;
      max-width: 92vw;
      text-align:center;
    }
    .toast.show{ opacity: 1; }

    .hidden-file{
      position:absolute;
      left:-9999px;
      width:1px;
      height:1px;
      overflow:hidden;
    }

    @media (max-width: 980px){
      body{ padding:16px; }
      .wrap{ flex-direction: column; }
      form.card{ max-width: 100%; flex: 1 1 auto; }
      .side-info.card{ width: 100%; }
      .headline-actions{ width:100%; }
      .soft-btn{ width:100%; justify-content:center; }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="top-alert">
      Bu avtomatik sistemdir. ElanÄ±nÄ±z yalnÄ±z adminÉ™ <b>hazÄ±r ÅŸÉ™kildÉ™ yaradÄ±lmÄ±ÅŸ form</b> vÉ™ <b>dÃ¼zgÃ¼n bilet</b> gÃ¶ndÉ™rildikdÉ™ paylaÅŸÄ±lÄ±r.
    </div>

    <h2>ğŸ“¦ AparÄ±ram Formu</h2>

    <!-- âœ… Ä°stÉ™diyiniz kimi: yalnÄ±z 2 dÃ¼ymÉ™ -->
    <div class="headline-actions">
      <button type="button" class="soft-btn red" id="goRulesBtn">Qaydalar</button>
      <a class="soft-btn green" href="https://bit.ly/3kklACf" target="_blank" rel="noopener noreferrer">AG Whatsap qrupu</a>
    </div>

    <div class="wrap">
      <form id="aparForm" class="card" autocomplete="off">
        <div class="section-title"><span class="dot"></span>Formu doldurun</div>

        <label>YÃ¶n seÃ§in</label>
        <select id="direction" required>
          <option value="BakÄ±â€“Ä°zmir">BakÄ±â€“Ä°zmir</option>
          <option value="Ä°zmirâ€“BakÄ±">Ä°zmirâ€“BakÄ±</option>
        </select>

        <label>Tarix</label>
        <input type="date" id="date" required />
        <div id="dateError" class="error"></div>

        <label>Ã–dÉ™niÅŸ</label>
        <select id="payment" required>
          <option value="Ã¶dÉ™niÅŸsiz">Ã–dÉ™niÅŸsiz</option>
          <option value="Ã¶dÉ™niÅŸli">Ã–dÉ™niÅŸli</option>
        </select>

        <div id="tariffOptions" style="display:none;">
          <label style="display:flex; align-items:center; gap:6px; flex-wrap:wrap;">
            <span>QiymÉ™t sÉ™viyyÉ™si</span>
            <button type="button" class="inline-link-btn red" id="tariffInfoBtn">ÆtraflÄ± mÉ™lumat almaq Ã¼Ã§Ã¼n kliklÉ™yin</button>
          </label>

          <select id="tariff">
            <option value="#QT">#QT â€” Qrup tarifinÉ™ uyÄŸun</option>
            <option value="#QTA">#QTA â€” Qrup tarifindÉ™n aÅŸaÄŸÄ±</option>
            <option value="#QTY">#QTY â€” Qrup tarifindÉ™n yuxarÄ±</option>
          </select>
        </div>

        <label>Apara bilÉ™cÉ™yiniz ÅŸeylÉ™r</label>
        <div class="checkbox-group">
          <label class="chip">ğŸ“„ <input type="checkbox" value="sÉ™nÉ™d" /> SÉ™nÉ™d</label>
          <label class="chip">ğŸ <input type="checkbox" value="É™ÅŸya" /> ÆÅŸya</label>
          <label class="chip">ğŸ’ <input type="checkbox" value="baqaj" /> Baqaj</label>
        </div>
        <div id="itemError" class="error">AparacaÄŸÄ±nÄ±z ÅŸeyi seÃ§mÉ™lisiniz (SÉ™nÉ™d / ÆÅŸya / Baqaj).</div>

        <label>WhatsApp nÃ¶mrÉ™niz (+994 / +90 ilÉ™)</label>
        <input type="text" id="phone" placeholder="+994551234567" required />
        <div id="phoneError" class="error">NÃ¶mrÉ™ formatÄ± dÃ¼zgÃ¼n deyil. NÃ¼munÉ™: +994XXXXXXXXX vÉ™ ya +90XXXXXXXXXX</div>

        <label>WhatsApp nÃ¶mrÉ™nizi tÉ™krar yazÄ±n (tÉ™sdiq)</label>
        <input type="text" id="phoneConfirm" placeholder="+994551234567" />
        <div id="phoneMatchError" class="error">ElandakÄ± nÃ¶mrÉ™ ilÉ™ WhatsApp nÃ¶mrÉ™niz eyni olmalÄ±dÄ±r.</div>

        <div class="warn-note">
          âš ï¸ AdminÉ™ elan gÃ¶ndÉ™rdiyiniz nÃ¶mrÉ™ ilÉ™ elanda yazdÄ±ÄŸÄ±nÄ±z nÃ¶mrÉ™ eyni olmalÄ±dÄ±r. UyÄŸun gÉ™lmÉ™zsÉ™, elan paylaÅŸÄ±lmÄ±r.
        </div>

        <label style="margin-top:14px;">TÉ™yyarÉ™ bileti (PDF/ÅŸÉ™kil)</label>
        <div class="muted">
          BiletdÉ™ <b>Ad</b>, <b>Soyad</b>, <b>PNR/bilet nÃ¶mrÉ™si</b>, <b>uÃ§uÅŸ tarixi</b> vÉ™ <b>uÃ§uÅŸ istiqamÉ™ti</b> mÃ¼tlÉ™q gÃ¶rÃ¼nmÉ™lidir.
        </div>

        <div class="sub-actions">
          <button type="button" class="mini-btn" id="pickTicketBtn">ğŸ“ Bileti seÃ§</button>
          <button type="button" class="mini-btn danger" id="removeTicketBtn" disabled>ğŸ—‘ï¸ Bileti sil</button>
        </div>

        <input class="hidden-file" type="file" id="ticketFile" accept="application/pdf,image/*" />

        <div class="status-row" id="ticketStatusRow" style="display:none;">
          <span class="status-pill ok">âœ… Bilet yÃ¼klÉ™ndi</span>
          <span class="file-name" id="ticketFileName"></span>
        </div>

        <div id="ticketError" class="error"></div>

        <button type="button" id="genBtn" class="btn">Elan HazÄ±rla</button>
      </form>

      <aside class="side-info card" id="qisa-qaydalar">
        <div class="section-title"><span class="dot"></span>Qaydalar vÉ™ mÉ™lumat</div>

        <div class="rule-block">
          <div class="rule-title">ğŸ§³ APAR GÆTÄ°R QRUPU â€” QAYDALAR VÆ MÆLUMAT</div>

          <div class="muted">
            ğŸŸ¢ Bu qrupun mÉ™qsÉ™di insanlarÄ±n bir-birinÉ™ kÃ¶mÉ™k etmÉ™sini vÉ™ Ä°zmirâ€“BakÄ± / BakÄ±â€“Ä°zmir istiqamÉ™tindÉ™ gÃ¶ndÉ™riÅŸlÉ™rin daha asan, sÃ¼rÉ™tli vÉ™ sÉ™rfÉ™li tÉ™ÅŸkilini tÉ™min etmÉ™kdir.
            <br><br>
            Burada siz sÉ™nÉ™d, Ã§anta vÉ™ ya digÉ™r ÅŸÉ™xsi É™ÅŸyalarÄ± hÉ™m pulsuz, hÉ™m dÉ™ razÄ±laÅŸdÄ±rÄ±lmÄ±ÅŸ mÉ™blÉ™ÄŸ qarÅŸÄ±lÄ±ÄŸÄ±nda
            <button type="button" class="inline-link-btn red" id="tariffJumpBtn">Qrup tariflÉ™ri</button>
            gÃ¶ndÉ™rÉ™ vÉ™ ya apara bilÉ™rsiniz.
            <br>
            Qrup ticari mÉ™qsÉ™d daÅŸÄ±mÄ±r â€” bu, sadÉ™cÉ™ yardÄ±mlaÅŸma platformasÄ±dÄ±r.
          </div>
        </div>

        <div class="rule-block" id="group-rules">
          <div class="rule-title">QÄ±saca qaydalar</div>
          <ul style="margin-top:8px;">
            <li><b>1)</b> Elan paylaÅŸmaq Ã¼Ã§Ã¼n qrupun Ã¼zvÃ¼ olmaq mÃ¼tlÉ™qdir.</li>
            <li><b>2)</b> Elanlar hÉ™ftÉ™dÉ™ <b>1 dÉ™fÉ™</b> paylaÅŸÄ±lÄ±r.</li>
            <li><b>3)</b> HÉ™r <b>#APARIRAM</b> elanÄ± Ã¼Ã§Ã¼n bilet (PDF vÉ™ ya ÅŸÉ™kil formatÄ±nda) gÃ¶ndÉ™rmÉ™k <b>mÃ¼tlÉ™qdir</b>.
              Bu, saxta elanlarÄ±n qarÅŸÄ±sÄ±nÄ± almaq Ã¼Ã§Ã¼n tÉ™tbiq olunur. (BiletdÉ™ <b>ad</b>, <b>soyad</b> vÉ™ <b>PNR</b> nÃ¶mrÉ™si gÃ¶rÃ¼nmÉ™lidir.)
            </li>

            <li><b>4)</b> PaylaÅŸÄ±lan â€œAparÄ±ramâ€ kontaktlarÄ± ilÉ™ aÅŸaÄŸÄ±dakÄ± mÉ™hsullarla baÄŸlÄ± gÃ¶ndÉ™riÅŸ istÉ™mÉ™k <b>qadaÄŸandÄ±r</b> vÉ™ bu halda <b>qrupdan Ã§Ä±xarÄ±la bilÉ™rsiniz</b>.
              AdminlÉ™r vÉ™ qrup bu cÃ¼r mÉ™hsullarÄ±n daÅŸÄ±nmasÄ±, gÃ¶mrÃ¼k vÉ™ hÉ™r hansÄ± hÃ¼quqi hadisÉ™lÉ™rdÉ™ <b>mÉ™suliyyÉ™t daÅŸÄ±mÄ±r</b>.
              XahiÅŸ edirik, belÉ™ tÉ™klif edÉ™nlÉ™ri bizÉ™ bildirin.
              <div style="margin-top:8px;">
                <div>Alkoqollu iÃ§kilÉ™r ğŸ·</div>
                <div>Siqaret vÉ™ tÃ¼tÃ¼n mÉ™hsullarÄ± ğŸš­</div>
                <div>Elektron siqaretlÉ™r ğŸ”‹</div>
                <div>DÉ™rman vÉ™ kosmetik vasitÉ™lÉ™r ğŸ’ŠğŸ’„</div>
              </div>
            </li>

            <li><b>5)</b> Elanlar yalnÄ±z <b>rÉ™qÉ™msal</b> vÉ™ <b>dÃ¼zgÃ¼n formatda</b> qÉ™bul edilir. SÉ™hv formatda gÃ¶ndÉ™rilÉ™n elanlar paylaÅŸÄ±lmayacaq.</li>
            <li><b>6)</b> Elan gÃ¶ndÉ™rmÉ™ saatÄ± â€” <b>08:00â€“19:00</b> (TR vaxtÄ± ilÉ™). Bu saatlardan kÉ™nar adminlÉ™rÉ™ yazmaq <b>qadaÄŸandÄ±r</b> (qrupdan Ã§Ä±xarÄ±la bilÉ™rsiniz).</li>
          </ul>
        </div>

        <div class="rule-block" id="qrup-tarifleri">
          <div class="rule-title">ğŸ’° Qrup tariflÉ™ri (orta)</div>

          <div class="muted">
            ***GÃ¶ndÉ™rmÉ™k Ã¼Ã§Ã¼n istÉ™nilÉ™n tarifi seÃ§É™ bilÉ™rsiniz.
          </div>

          <ul style="margin-top:8px;">
            <li>2 kq-a qÉ™dÉ™r: <b>25 AZN</b></li>
            <li>2â€“5 kq (daxil): <b>50 AZN</b></li>
            <li>5 kq-dan yuxarÄ±: hÉ™r É™lavÉ™ 1 kq Ã¼Ã§Ã¼n <b>10 AZN</b></li>
            <li>SÉ™nÉ™d (1 É™dÉ™d): <b>20 AZN</b></li>
          </ul>

          <div class="rule-title" style="margin-top:12px;">ğŸ”– QiymÉ™t sÉ™viyyÉ™si</div>
          <div class="muted">
            <span class="pill">#QT â€” uyÄŸun</span>
            <span class="pill">#QTA â€” aÅŸaÄŸÄ±</span>
            <span class="pill">#QTY â€” yuxarÄ±</span>
          </div>
        </div>

        <div class="danger-text">
          Ãœz vurmayÄ±n â€” admin xÉ™bÉ™rdarlÄ±q etmÉ™yÉ™cÉ™k vÉ™ yazdÄ±qlarÄ±nÄ±za cavab vermÉ™yÉ™cÉ™k.
        </div>
      </aside>
    </div>

    <div id="result" class="card result" style="display:none;"></div>
  </div>

  <div id="toast" class="toast">KopyalandÄ± âœ…</div>

  <script>
    const ADMIN_PHONE_RAW = "+380503693882";
    let lastElanText = "";
    let selectedTicket = null;

    const ticketFileInput = document.getElementById("ticketFile");
    const pickTicketBtn = document.getElementById("pickTicketBtn");
    const removeTicketBtn = document.getElementById("removeTicketBtn");
    const ticketStatusRow = document.getElementById("ticketStatusRow");
    const ticketFileName = document.getElementById("ticketFileName");
    const ticketError = document.getElementById("ticketError");

    const dateInput = document.getElementById("date");
    const dateError = document.getElementById("dateError");

    const phoneInput = document.getElementById("phone");
    const phoneConfirmInput = document.getElementById("phoneConfirm");
    const phoneMatchError = document.getElementById("phoneMatchError");

    const tariffInfoBtn = document.getElementById("tariffInfoBtn");
    const tariffJumpBtn = document.getElementById("tariffJumpBtn");
    const qrupTarifleriEl = document.getElementById("qrup-tarifleri");

    const resultDiv = document.getElementById("result");

    // âœ… â€œQaydalarâ€ dÃ¼ymÉ™si bu bloka aparÄ±r
    const goRulesBtn = document.getElementById("goRulesBtn");
    const rulesPanel = document.getElementById("qisa-qaydalar");
    if(goRulesBtn && rulesPanel){
      goRulesBtn.addEventListener("click", () => {
        rulesPanel.scrollIntoView({ behavior:"smooth", block:"start" });
      });
    }

    function toISODate(d){
      const yyyy = d.getFullYear();
      const mm = String(d.getMonth()+1).padStart(2,"0");
      const dd = String(d.getDate()).padStart(2,"0");
      return `${yyyy}-${mm}-${dd}`;
    }

    function addMonthsSafe(dateObj, months){
      const d = new Date(dateObj);
      const targetMonth = d.getMonth() + months;
      const targetYear = d.getFullYear() + Math.floor(targetMonth / 12);
      const monthIndex = (targetMonth % 12 + 12) % 12;
      const day = d.getDate();

      const lastDay = new Date(targetYear, monthIndex + 1, 0).getDate();
      const clampedDay = Math.min(day, lastDay);
      return new Date(targetYear, monthIndex, clampedDay);
    }

    const today = new Date();
    today.setHours(0,0,0,0);
    const maxDate = addMonthsSafe(today, 1);

    dateInput.min = toISODate(today);
    dateInput.max = toISODate(maxDate);

    function showDateError(msg){
      dateError.textContent = msg;
      dateError.style.display = "block";
    }
    function hideDateError(){
      dateError.textContent = "";
      dateError.style.display = "none";
    }

    function validateDate(selectedISO){
      if(!selectedISO){
        showDateError("Tarixi seÃ§mÉ™lisiniz.");
        return false;
      }

      const chosen = new Date(selectedISO + "T00:00:00");
      chosen.setHours(0,0,0,0);

      if(chosen < today){
        showDateError("KeÃ§miÅŸ tarix seÃ§mÉ™k olmaz.");
        return false;
      }

      if(chosen > maxDate){
        showDateError("ElanlarÄ±mÄ±z yalnÄ±z bir ay iÃ§indÉ™ki tarixlÉ™r Ã¼Ã§Ã¼n uyÄŸun ÅŸÉ™kildÉ™ verilmÉ™lidir.");
        return false;
      }

      hideDateError();
      return true;
    }

    dateInput.addEventListener("change", () => validateDate(dateInput.value));

    function jumpToTariffs(){
      if(!qrupTarifleriEl) return;
      qrupTarifleriEl.scrollIntoView({ behavior: "smooth", block: "start" });
    }
    if (tariffInfoBtn) tariffInfoBtn.addEventListener("click", jumpToTariffs);
    if (tariffJumpBtn) tariffJumpBtn.addEventListener("click", jumpToTariffs);

    function showToast(msg){
      const t = document.getElementById("toast");
      t.textContent = msg;
      t.classList.add("show");
      clearTimeout(showToast._timer);
      showToast._timer = setTimeout(() => t.classList.remove("show"), 1500);
    }

    function sanitizeFileName(name){
      if(!name) return "";
      return name.length > 44 ? (name.slice(0, 30) + "..." + name.slice(-10)) : name;
    }

    function updateTicketUI(){
      if(selectedTicket){
        ticketStatusRow.style.display = "flex";
        ticketFileName.textContent = "â€¢ " + sanitizeFileName(selectedTicket.name);
        removeTicketBtn.disabled = false;
      }else{
        ticketStatusRow.style.display = "none";
        ticketFileName.textContent = "";
        removeTicketBtn.disabled = true;
      }
    }

    function showTicketError(msg){
      ticketError.textContent = msg;
      ticketError.style.display = "block";
    }
    function hideTicketError(){
      ticketError.textContent = "";
      ticketError.style.display = "none";
    }

    pickTicketBtn.addEventListener("click", () => ticketFileInput.click());

    ticketFileInput.addEventListener("change", () => {
      const f = ticketFileInput.files && ticketFileInput.files[0] ? ticketFileInput.files[0] : null;
      if(!f){
        selectedTicket = null;
        updateTicketUI();
        showTicketError("â— Bilet yÃ¼klÉ™nmÉ™yib. apargetir.bot biletinizi yoxlamalÄ±dÄ±r â€” bilet (PDF vÉ™ ya ÅŸÉ™kil) yÃ¼klÉ™nmÉ™dÉ™n elan hazÄ±rlamaq olmaz.");
        return;
      }

      const okType = f.type === "application/pdf" || (f.type && f.type.startsWith("image/"));
      if(!okType){
        selectedTicket = null;
        ticketFileInput.value = "";
        updateTicketUI();
        showTicketError("â— ZÉ™hmÉ™t olmasa bilet Ã¼Ã§Ã¼n yalnÄ±z PDF vÉ™ ya ÅŸÉ™kil (JPG/PNG vÉ™ s.) yÃ¼klÉ™yin.");
        return;
      }

      selectedTicket = f;
      updateTicketUI();
      hideTicketError();
      showToast("Bilet yÃ¼klÉ™ndi âœ…");
    });

    removeTicketBtn.addEventListener("click", () => {
      selectedTicket = null;
      ticketFileInput.value = "";
      updateTicketUI();
      showTicketError("â— Bilet silindi. apargetir.bot biletinizi yoxlamalÄ±dÄ±r â€” bilet yÃ¼klÉ™nmÉ™dÉ™n elan hazÄ±rlamaq olmaz.");
      showToast("Bilet silindi");
    });

    document.getElementById("payment").addEventListener("change", function() {
      document.getElementById("tariffOptions").style.display =
        this.value === "Ã¶dÉ™niÅŸli" ? "block" : "none";
    });

    function normalizePhone(p){ return (p || "").replace(/\s/g,""); }
    function isValidPhone(input){
      const raw = normalizePhone(input);
      return /^(\+994\d{9}|\+90\d{10})$/.test(raw);
    }

    function validatePhoneMatch(){
      const p1 = normalizePhone(phoneInput.value.trim());
      const p2 = normalizePhone(phoneConfirmInput.value.trim());

      if(!p2){
        phoneMatchError.style.display = "none";
        return true;
      }

      if(p1 && p2 && p1 === p2){
        phoneMatchError.style.display = "none";
        return true;
      }

      phoneMatchError.style.display = "block";
      return false;
    }

    phoneInput.addEventListener("input", validatePhoneMatch);
    phoneConfirmInput.addEventListener("input", validatePhoneMatch);

    function formatDateDDMMYYYY(isoDate){
      const d = new Date(isoDate + "T00:00:00");
      const dd = String(d.getDate()).padStart(2,"0");
      const mm = String(d.getMonth()+1).padStart(2,"0");
      const yyyy = d.getFullYear();
      return `${dd}.${mm}.${yyyy}`;
    }

    function validateFormBeforeBuild(){
      let valid = true;

      if(!validateDate(dateInput.value)) valid = false;

      const itemsArr = Array.from(document.querySelectorAll(".checkbox-group input:checked"));
      if(itemsArr.length === 0){
        document.getElementById("itemError").style.display = "block";
        valid = false;
      }else{
        document.getElementById("itemError").style.display = "none";
      }

      const phone = phoneInput.value.trim();
      document.getElementById("phoneError").style.display = (!isValidPhone(phone)) ? "block" : "none";
      if(!isValidPhone(phone)) valid = false;

      const confirm = phoneConfirmInput.value.trim();
      if(!confirm){
        phoneMatchError.textContent = "WhatsApp nÃ¶mrÉ™nizi tÉ™krar yazÄ±n (tÉ™sdiq).";
        phoneMatchError.style.display = "block";
        valid = false;
      }else{
        phoneMatchError.textContent = "ElandakÄ± nÃ¶mrÉ™ ilÉ™ WhatsApp nÃ¶mrÉ™niz eyni olmalÄ±dÄ±r.";
        if(!validatePhoneMatch()) valid = false;
      }

      if(!selectedTicket){
        showTicketError("â— Bilet yÃ¼klÉ™nmÉ™yib. apargetir.bot biletinizi yoxlamalÄ±dÄ±r â€” buna gÃ¶rÉ™ bilet (PDF vÉ™ ya ÅŸÉ™kil) yÃ¼klÉ™nmÉ™dÉ™n elan hazÄ±rlamaq olmaz.");
        valid = false;
      }else{
        hideTicketError();
      }

      return valid;
    }

    function buildElanText(){
      const direction = document.getElementById("direction").value;
      const date = document.getElementById("date").value;
      const payment = document.getElementById("payment").value;
      const tariff = document.getElementById("tariff").value;
      const phone = normalizePhone(phoneInput.value.trim());

      const itemsArr = Array.from(document.querySelectorAll(".checkbox-group input:checked"))
        .map(cb => cb.value);

      const formattedDate = formatDateDDMMYYYY(date);

      let paymentText = "";
      let tagText = "";
      if (payment === "Ã¶dÉ™niÅŸli") {
        tagText = " " + tariff;
        paymentText = "Ã–dÉ™niÅŸli";
      } else {
        paymentText = "Ã–dÉ™niÅŸsiz";
      }

      const items = itemsArr.join(", ");

      return `#APARIRAM${tagText}
1) ${direction}
2) ${formattedDate}
3) ${paymentText}
4) ${items}
5) Bu nÃ¶mrÉ™yÉ™ kliklÉ™yÉ™rÉ™k aparanla É™laqÉ™ saxlaya bilÉ™rsiniz: ${phone}`;
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      } catch(e){
        const ta = document.createElement("textarea");
        ta.value = text;
        ta.style.position = "fixed";
        ta.style.opacity = "0";
        document.body.appendChild(ta);
        ta.select();
        const ok = document.execCommand("copy");
        document.body.removeChild(ta);
        return ok;
      }
    }

    function openWhatsAppToAdminWithText(text){
      const url =
        "https://wa.me/" + ADMIN_PHONE_RAW.replace(/\D/g,"") +
        "?text=" + encodeURIComponent(text);

      window.open(url, "_blank", "noopener,noreferrer");
    }

    function generateResult() {
      if(!validateFormBeforeBuild()){
        showToast("Formda sÉ™hv var âš ï¸");
        if(dateError.style.display === "block") dateInput.scrollIntoView({behavior:"smooth", block:"center"});
        else if(document.getElementById("itemError").style.display === "block") document.getElementById("itemError").scrollIntoView({behavior:"smooth", block:"center"});
        else if(document.getElementById("phoneError").style.display === "block") document.getElementById("phoneError").scrollIntoView({behavior:"smooth", block:"center"});
        else if(phoneMatchError.style.display === "block") phoneMatchError.scrollIntoView({behavior:"smooth", block:"center"});
        else if(ticketError.style.display === "block") ticketError.scrollIntoView({behavior:"smooth", block:"center"});
        return;
      }

      lastElanText = buildElanText();
      resultDiv.style.display = "block";

      resultDiv.innerHTML =
        `<pre>${lastElanText}</pre>

         <div class="action-row">
           <div style="flex:1; min-width:260px;">
             <div class="big-hint">Tebrikler :) ElanÄ±nÄ±z yaradÄ±ldÄ± ! â¬‡ï¸ AltdakÄ± yaÅŸÄ±l dÃ¼ymÉ™yÉ™ kliklÉ™yÉ™rÉ™k elanÄ± WhatsApp vasitÉ™silÉ™ adminÉ™ gÃ¶ndÉ™rin.</div>

             <div class="big-danger">â— <b>Biletiniz bot tÉ™rÉ™findÉ™n yoxlanÄ±ldÄ±, amma adminÉ™ gÃ¶ndÉ™rilmÉ™di.</b> Biletinizi (PDF vÉ™ ya ÅŸÉ™kil ÅŸÉ™klindÉ™ â€” Ã¼stÃ¼ndÉ™ <b>ad, soyad, tarix, uÃ§uÅŸ istiqamÉ™ti</b> yazÄ±lan) mÃ¼tlÉ™q adminÉ™ gÃ¶ndÉ™rin!</div>

             <div class="muted" style="margin-top:10px; font-weight:1000;">
               Bu dÃ¼ymÉ™yÉ™ kliklÉ™yÉ™rÉ™k elanÄ± WhatsApp vasitÉ™silÉ™ adminÉ™ gÃ¶ndÉ™rin.
             </div>

             <button class="wa-send-btn" type="button" id="waBtn">WhatsApp-la adminÉ™ gÃ¶ndÉ™r</button>
           </div>
         </div>

         <div class="danger-footer">
           WhatsApp dÃ¼ymÉ™si iÅŸlÉ™mÉ™dikdÉ™, elanlarÄ±nÄ±zÄ± bu nÃ¶mrÉ™yÉ™ gÃ¶ndÉ™rÉ™ bilÉ™rsiniz: <b>+380 503 69 38 82</b><br>
           â° QÉ™bul saatÄ±: <b>08:00â€“19:00</b> (TR vaxtÄ± ilÉ™). Bu saatlardan kÉ™nar gÃ¶ndÉ™rilÉ™n elanlar <b>paylaÅŸÄ±lmÄ±r</b>.
         </div>

         <div class="action-row" style="margin-top:12px;">
           <button class="copy-btn" type="button" id="copyBtn">ElanÄ± Kopyala</button>
         </div>

         <p>
           <b>â€œElanÄ± Kopyalaâ€</b> dÃ¼ymÉ™sinÉ™ basÄ±n â€” elan avtomatik kopyalanacaq.
           Daha sonra <b>WhatsApp</b> vasitÉ™silÉ™ adminÉ™ gÃ¶ndÉ™rin.
           Sonra biletinizi <b>PDF/ÅŸÉ™kil</b> formatÄ±nda tÉ™qdim edin
           (biletdÉ™ <b>Ad</b>, <b>Soyad</b>, <b>PNR/bilet nÃ¶mrÉ™si</b>, <b>uÃ§uÅŸ tarixi</b> vÉ™ <b>uÃ§uÅŸ istiqamÉ™ti</b> gÃ¶rÃ¼nmÉ™lidir).
           UyÄŸun olmayan biletlÉ™r vÉ™ fÉ™rqli nÃ¶mrÉ™ ilÉ™ gÃ¶ndÉ™rilÉ™n elanlar <b>paylaÅŸÄ±lmÄ±r</b>.
         </p>
        `;

      document.getElementById("copyBtn").addEventListener("click", async () => {
        const ok = await copyText(lastElanText);
        showToast(ok ? "Elan kopyalandÄ± âœ…" : "Kopyalama alÄ±nmadÄ± âŒ");
      });

      document.getElementById("waBtn").addEventListener("click", () => {
        const p1 = normalizePhone(phoneInput.value.trim());
        const p2 = normalizePhone(phoneConfirmInput.value.trim());
        if(!p2 || p1 !== p2){
          alert("ElandakÄ± nÃ¶mrÉ™ ilÉ™ WhatsApp nÃ¶mrÉ™niz eyni olmalÄ±dÄ±r.");
          return;
        }
        openWhatsAppToAdminWithText(lastElanText);
        showToast("WhatsApp aÃ§Ä±ldÄ± âœ…");
      });

      resultDiv.scrollIntoView({ behavior: "smooth", block: "start" });
    }

    document.getElementById("genBtn").addEventListener("click", generateResult);
    updateTicketUI();
  </script>
</body>
</html>
